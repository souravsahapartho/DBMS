-- Library Database Solution (SQL)
-- Part A — Table Creation & Data Insertion

-- 1) Create table library_books
CREATE TABLE library_books (
    book_id VARCHAR(20) PRIMARY KEY,
    book_title VARCHAR(40) NOT NULL,
    author VARCHAR(30),
    price DECIMAL(8,2)
);

-- 2) Create table members (with foreign key referencing library_books.book_id)
CREATE TABLE members (
    member_id INT PRIMARY KEY,
    member_name VARCHAR(30),
    membership_type VARCHAR(20),
    borrowed_book VARCHAR(20),
    CONSTRAINT fk_borrowed_book FOREIGN KEY (borrowed_book) REFERENCES library_books(book_id)
);

-- 3) Insert records into library_books
INSERT INTO library_books (book_id, book_title, author, price) VALUES
('B101', 'Database Systems', 'Navathe', 500.00),
('B102', 'Clean Code', 'Robert Martin', 700.00),
('B103', 'Algorithms', 'CLRS', 900.00);

-- 4) Insert records into members
INSERT INTO members (member_id, member_name, membership_type, borrowed_book) VALUES
(1, 'Rahim', 'Regular', 'B101'),
(2, 'Karim', 'Premium', 'B103');

-- Part B — Table Modification

-- 5) Add a new column email to members
ALTER TABLE members
ADD COLUMN email VARCHAR(40);

-- 6) Add published_year and category to library_books
ALTER TABLE library_books
ADD COLUMN published_year INT,
ADD COLUMN category VARCHAR(20);

-- 7) Modify the data type of price in library_books
-- NOTE: DECIMAL is preferred for money. This changes precision to (10,2).
ALTER TABLE library_books
MODIFY COLUMN price DECIMAL(10,2);

-- 8) Delete the membership_type column from members
ALTER TABLE members
DROP COLUMN membership_type;

-- 9) Rename member_name to full_name
ALTER TABLE members
CHANGE COLUMN member_name full_name VARCHAR(30);

-- 10) Rename the table library_books to books_archive
ALTER TABLE library_books
RENAME TO books_archive;

-- 11) Finally, delete the entire members table
DROP TABLE members;

-- End of library solution SQL file.
